<!DOCTYPE html>
<html lang="pt-BR" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FinanceApp - Controle Financeiro Inteligente</title>
    <link rel="icon" href="assets/logo.png">
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Supabase -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <!-- jsPDF para relatórios -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jspdf-autotable@3.5.28/dist/jspdf.plugin.autotable.min.js"></script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Estilos -->
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/themes.css">
    <link rel="stylesheet" href="css/responsive.css">
</head>
<body>
    <!-- Loading Screen -->
    <div id="loadingScreen" class="loading-screen">
        <div class="loading-content">
            <img src="https://i.ibb.co/9mt6zRFj/generated-image-removebg-preview.png" alt="FinanceApp" class="loading-logo">
            <div class="spinner"></div>
            <p>Carregando suas finanças...</p>
        </div>
    </div>

    <!-- Header -->
    <header class="main-header">
        <div class="header-container">
            <!-- Logo -->
            <div class="logo-section">
                <img src="https://i.ibb.co/9mt6zRFj/generated-image-removebg-preview.png" alt="FinanceApp" class="main-logo">
                <span class="app-name">FinanceApp</span>
            </div>

            <!-- Menu Mobile Toggle -->
            <button class="menu-toggle" onclick="toggleMenu()">
                <i class="fas fa-bars"></i>
            </button>

            <!-- Navigation -->
            <nav class="main-nav" id="mainNav">
                <a href="#" onclick="showPage('dashboard')" class="nav-link active">
                    <i class="fas fa-chart-line"></i>
                    <span>Dashboard</span>
                </a>
                <a href="#" onclick="showPage('cards')" class="nav-link">
                    <i class="fas fa-credit-card"></i>
                    <span>Cartões</span>
                </a>
                <a href="#" onclick="showPage('accounts')" class="nav-link">
                    <i class="fas fa-university"></i>
                    <span>Contas</span>
                </a>
                <a href="#" onclick="showPage('transactions')" class="nav-link">
                    <i class="fas fa-exchange-alt"></i>
                    <span>Transações</span>
                </a>
                <a href="#" onclick="showPage('goals')" class="nav-link">
                    <i class="fas fa-bullseye"></i>
                    <span>Metas</span>
                </a>
                <a href="#" onclick="showPage('reports')" class="nav-link">
                    <i class="fas fa-file-pdf"></i>
                    <span>Relatórios</span>
                </a>
                <a href="#" onclick="showPage('settings')" class="nav-link">
                    <i class="fas fa-cog"></i>
                    <span>Configurações</span>
                </a>
            </nav>

            <!-- User Area -->
            <div class="user-area">
                <!-- Not Logged In -->
                <div id="loggedOutState">
                    <button class="btn btn-login" onclick="openLoginModal()">
                        <i class="fas fa-sign-in-alt"></i>
                        <span>Entrar</span>
                    </button>
                </div>

                <!-- Logged In -->
                <div id="loggedInState" style="display: none;">
                    <div class="user-profile" onclick="toggleUserMenu()">
                        <img id="userAvatar" src="https://ui-avatars.com/api/?name=U&background=49ac2a&color=fff" alt="Avatar" class="user-avatar">
                        <div class="user-info">
                            <span id="userName">Usuário</span>
                            <span class="premium-badge">
                                <i class="fas fa-crown"></i> Premium
                            </span>
                        </div>
                        <i class="fas fa-chevron-down"></i>
                    </div>

                    <!-- User Dropdown Menu -->
                    <div class="user-dropdown" id="userDropdown">
                        <div class="dropdown-header">
                            <img id="dropdownAvatar" src="https://ui-avatars.com/api/?name=U&background=49ac2a&color=fff" alt="Avatar">
                            <div>
                                <strong id="dropdownName">Usuário</strong>
                                <small id="dropdownEmail">usuario@email.com</small>
                            </div>
                        </div>
                        <div class="dropdown-divider"></div>
                        <a href="#" onclick="openProfileModal()">
                            <i class="fas fa-user-edit"></i> Editar Perfil
                        </a>
                        <a href="#" onclick="openThemeSettings()">
                            <i class="fas fa-palette"></i> Tema
                        </a>
                        <a href="#" onclick="openNotificationsSettings()">
                            <i class="fas fa-bell"></i> Notificações
                        </a>
                        <div class="dropdown-divider"></div>
                        <a href="#" onclick="handleLogout()" class="logout-btn">
                            <i class="fas fa-sign-out-alt"></i> Sair
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Dashboard Page -->
        <section id="dashboardPage" class="page active">
            <div class="page-header">
                <h1><i class="fas fa-chart-line"></i> Dashboard Financeiro</h1>
                <p>Visão completa das suas finanças</p>
            </div>

            <!-- Period Filter -->
            <div class="period-filter">
                <div class="filter-group">
                    <label><i class="fas fa-calendar-alt"></i> Período:</label>
                    <input type="date" id="startDate" class="date-input">
                    <span>até</span>
                    <input type="date" id="endDate" class="date-input">
                    <button class="btn btn-primary" onclick="updateDashboard()">
                        <i class="fas fa-filter"></i> Filtrar
                    </button>
                </div>
                <div class="quick-stats">
                    <div class="stat-badge income">
                        <i class="fas fa-arrow-up"></i>
                        <span>Receitas: <strong id="totalIncome">R$ 0,00</strong></span>
                    </div>
                    <div class="stat-badge expense">
                        <i class="fas fa-arrow-down"></i>
                        <span>Despesas: <strong id="totalExpense">R$ 0,00</strong></span>
                    </div>
                    <div class="stat-badge balance">
                        <i class="fas fa-balance-scale"></i>
                        <span>Saldo: <strong id="totalBalance">R$ 0,00</strong></span>
                    </div>
                </div>
            </div>

            <!-- Summary Cards -->
            <div class="summary-grid">
                <div class="summary-card">
                    <div class="card-header">
                        <h3><i class="fas fa-wallet"></i> Contas Bancárias</h3>
                        <span class="card-badge success" id="accountsCount">0</span>
                    </div>
                    <div class="card-body">
                        <div class="card-value" id="totalAccountsBalance">R$ 0,00</div>
                        <div class="card-trend positive">
                            <i class="fas fa-arrow-up"></i> 5.2% este mês
                        </div>
                    </div>
                </div>

                <div class="summary-card">
                    <div class="card-header">
                        <h3><i class="fas fa-credit-card"></i> Cartões de Crédito</h3>
                        <span class="card-badge warning" id="cardsCount">0</span>
                    </div>
                    <div class="card-body">
                        <div class="card-value" id="totalCreditLimit">R$ 0,00</div>
                        <div class="card-subtitle">Limite disponível: <span id="availableCredit">R$ 0,00</span></div>
                    </div>
                </div>

                <div class="summary-card">
                    <div class="card-header">
                        <h3><i class="fas fa-bullseye"></i> Metas</h3>
                        <span class="card-badge info" id="goalsCount">0</span>
                    </div>
                    <div class="card-body">
                        <div class="card-value" id="goalsProgress">0%</div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="goalsProgressBar" style="width: 0%"></div>
                        </div>
                    </div>
                </div>

                <div class="summary-card">
                    <div class="card-header">
                        <h3><i class="fas fa-calendar-check"></i> Este Mês</h3>
                        <span class="card-badge danger" id="dueBills">0</span>
                    </div>
                    <div class="card-body">
                        <div class="card-value" id="monthlyExpense">R$ 0,00</div>
                        <div class="card-subtitle">Orçamento: <span id="monthlyBudget">R$ 0,00</span></div>
                    </div>
                </div>
            </div>

            <!-- Charts Section -->
            <div class="charts-grid">
                <div class="chart-container">
                    <div class="chart-header">
                        <h3><i class="fas fa-chart-pie"></i> Gastos por Categoria</h3>
                        <select id="categoryChartPeriod" onchange="updateCategoryChart()" class="chart-select">
                            <option value="month">Este Mês</option>
                            <option value="year">Este Ano</option>
                            <option value="all">Todo Período</option>
                        </select>
                    </div>
                    <canvas id="categoryChart"></canvas>
                </div>

                <div class="chart-container">
                    <div class="chart-header">
                        <h3><i class="fas fa-chart-bar"></i> Receitas vs Despesas</h3>
                        <select id="incomeExpensePeriod" onchange="updateIncomeExpenseChart()" class="chart-select">
                            <option value="6">Últimos 6 meses</option>
                            <option value="12">Último ano</option>
                            <option value="24">Últimos 2 anos</option>
                        </select>
                    </div>
                    <canvas id="incomeExpenseChart"></canvas>
                </div>

                <div class="chart-container full-width">
                    <div class="chart-header">
                        <h3><i class="fas fa-chart-line"></i> Evolução Patrimonial</h3>
                        <select id="wealthPeriod" onchange="updateWealthChart()" class="chart-select">
                            <option value="3">3 meses</option>
                            <option value="6">6 meses</option>
                            <option value="12">1 ano</option>
                        </select>
                    </div>
                    <canvas id="wealthChart"></canvas>
                </div>
            </div>

            <!-- Recent Transactions -->
            <div class="recent-transactions">
                <div class="section-header">
                    <h3><i class="fas fa-history"></i> Transações Recentes</h3>
                    <button class="btn btn-secondary" onclick="showPage('transactions')">
                        <i class="fas fa-eye"></i> Ver Todas
                    </button>
                </div>
                <div class="transactions-list" id="recentTransactions">
                    <!-- Transactions will be loaded here -->
                </div>
            </div>

            <!-- Financial Insights -->
            <div class="insights-grid">
                <div class="insight-card">
                    <div class="insight-icon success">
                        <i class="fas fa-lightbulb"></i>
                    </div>
                    <h4>Economia Potencial</h4>
                    <p id="potentialSavings">Identificamos R$ 0,00 em gastos que podem ser otimizados.</p>
                </div>

                <div class="insight-card">
                    <div class="insight-icon warning">
                        <i class="fas fa-exclamation-triangle"></i>
                    </div>
                    <h4>Alertas</h4>
                    <p id="financialAlerts">Nenhum alerta no momento.</p>
                </div>

                <div class="insight-card">
                    <div class="insight-icon info">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <h4>Previsão</h4>
                    <p id="financialForecast">Seu saldo previsto para o final do mês é de R$ 0,00.</p>
                </div>
            </div>
        </section>

        <!-- Cards Management Page -->
        <section id="cardsPage" class="page">
            <div class="page-header">
                <h1><i class="fas fa-credit-card"></i> Cartões de Crédito</h1>
                <p>Gerencie seus cartões e acompanhe os limites</p>
            </div>

            <div class="page-actions">
                <button class="btn btn-primary" onclick="openCardModal()">
                    <i class="fas fa-plus"></i> Novo Cartão
                </button>
                <div class="search-box">
                    <i class="fas fa-search"></i>
                    <input type="text" id="searchCards" placeholder="Buscar cartão..." oninput="filterCards()">
                </div>
            </div>

            <div class="cards-grid" id="cardsGrid">
                <!-- Cards will be loaded here -->
            </div>

            <div class="cards-table">
                <div class="table-header">
                    <h3><i class="fas fa-list"></i> Todos os Cartões</h3>
                    <div class="table-actions">
                        <button class="btn btn-secondary" onclick="exportCardsCSV()">
                            <i class="fas fa-download"></i> Exportar
                        </button>
                    </div>
                </div>
                <div class="table-responsive">
                    <table id="cardsTable">
                        <thead>
                            <tr>
                                <th>Bandeira</th>
                                <th>Banco</th>
                                <th>Últimos 4</th>
                                <th>Limite Total</th>
                                <th>Limite Usado</th>
                                <th>Disponível</th>
                                <th>Vencimento</th>
                                <th>Ações</th>
                            </tr>
                        </thead>
                        <tbody id="cardsTableBody">
                            <!-- Table rows will be loaded here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- Accounts Management Page -->
        <section id="accountsPage" class="page">
            <div class="page-header">
                <h1><i class="fas fa-university"></i> Contas Bancárias</h1>
                <p>Gerencie suas contas e acompanhe os saldos</p>
            </div>

            <div class="page-actions">
                <button class="btn btn-primary" onclick="openAccountModal()">
                    <i class="fas fa-plus"></i> Nova Conta
                </button>
                <button class="btn btn-secondary" onclick="openBalanceAdjustmentModal()">
                    <i class="fas fa-sync-alt"></i> Ajustar Saldo
                </button>
            </div>

            <div class="accounts-summary">
                <div class="summary-item">
                    <div class="summary-label">Saldo Total</div>
                    <div class="summary-value" id="totalBalanceSummary">R$ 0,00</div>
                </div>
                <div class="summary-item">
                    <div class="summary-label">Contas</div>
                    <div class="summary-value" id="totalAccounts">0</div>
                </div>
                <div class="summary-item">
                    <div class="summary-label">Última Atualização</div>
                    <div class="summary-value" id="lastUpdate">-</div>
                </div>
            </div>

            <div class="accounts-grid" id="accountsGrid">
                <!-- Accounts will be loaded here -->
            </div>

            <div class="transactions-history">
                <div class="section-header">
                    <h3><i class="fas fa-history"></i> Movimentações Recentes</h3>
                </div>
                <div class="table-responsive">
                    <table id="accountTransactionsTable">
                        <thead>
                            <tr>
                                <th>Data</th>
                                <th>Descrição</th>
                                <th>Categoria</th>
                                <th>Valor</th>
                                <th>Saldo</th>
                            </tr>
                        </thead>
                        <tbody id="accountTransactionsBody">
                            <!-- Transactions will be loaded here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- Transactions Page -->
        <section id="transactionsPage" class="page">
            <div class="page-header">
                <h1><i class="fas fa-exchange-alt"></i> Transações</h1>
                <p>Registre e gerencie todas as suas transações</p>
            </div>

            <!-- Transaction Filters -->
            <div class="filters-section">
                <div class="filter-row">
                    <div class="filter-group">
                        <label>Tipo:</label>
                        <select id="filterType" onchange="filterTransactions()">
                            <option value="all">Todos</option>
                            <option value="income">Receitas</option>
                            <option value="expense">Despesas</option>
                            <option value="transfer">Transferências</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>Categoria:</label>
                        <select id="filterCategory" onchange="filterTransactions()">
                            <option value="all">Todas</option>
                            <!-- Categories will be loaded dynamically -->
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>Período:</label>
                        <select id="filterPeriod" onchange="filterTransactions()">
                            <option value="all">Todo Período</option>
                            <option value="today">Hoje</option>
                            <option value="week">Esta Semana</option>
                            <option value="month" selected>Este Mês</option>
                            <option value="year">Este Ano</option>
                            <option value="custom">Personalizado</option>
                        </select>
                    </div>
                </div>
                <div class="filter-row" id="customDateFilter" style="display: none;">
                    <div class="filter-group">
                        <label>De:</label>
                        <input type="date" id="filterStartDate" onchange="filterTransactions()">
                    </div>
                    <div class="filter-group">
                        <label>Até:</label>
                        <input type="date" id="filterEndDate" onchange="filterTransactions()">
                    </div>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="quick-actions">
                <button class="btn btn-success" onclick="openTransactionModal('income')">
                    <i class="fas fa-plus-circle"></i> Nova Receita
                </button>
                <button class="btn btn-danger" onclick="openTransactionModal('expense')">
                    <i class="fas fa-minus-circle"></i> Nova Despesa
                </button>
                <button class="btn btn-info" onclick="openTransactionModal('transfer')">
                    <i class="fas fa-exchange-alt"></i> Transferência
                </button>
                <button class="btn btn-secondary" onclick="openImportModal()">
                    <i class="fas fa-upload"></i> Importar
                </button>
            </div>

            <!-- Transactions Table -->
            <div class="transactions-container">
                <div class="table-responsive">
                    <table id="transactionsTable">
                        <thead>
                            <tr>
                                <th>Data</th>
                                <th>Descrição</th>
                                <th>Categoria</th>
                                <th>Conta/Cartão</th>
                                <th>Valor</th>
                                <th>Status</th>
                                <th>Ações</th>
                            </tr>
                        </thead>
                        <tbody id="transactionsTableBody">
                            <!-- Transactions will be loaded here -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Pagination -->
            <div class="pagination" id="transactionsPagination">
                <!-- Pagination will be loaded here -->
            </div>
        </section>

        <!-- Goals Page -->
        <section id="goalsPage" class="page">
            <div class="page-header">
                <h1><i class="fas fa-bullseye"></i> Metas Financeiras</h1>
                <p>Defina e acompanhe seus objetivos financeiros</p>
            </div>

            <div class="goals-actions">
                <button class="btn btn-primary" onclick="openGoalModal()">
                    <i class="fas fa-plus"></i> Nova Meta
                </button>
                <div class="goals-filter">
                    <select id="goalsFilter" onchange="filterGoals()">
                        <option value="all">Todas as Metas</option>
                        <option value="active">Em Andamento</option>
                        <option value="completed">Concluídas</option>
                        <option value="failed">Não Concluídas</option>
                    </select>
                </div>
            </div>

            <div class="goals-stats">
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-trophy"></i>
                    </div>
                    <div class="stat-content">
                        <h3 id="completedGoals">0</h3>
                        <p>Metas Concluídas</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-running"></i>
                    </div>
                    <div class="stat-content">
                        <h3 id="activeGoals">0</h3>
                        <p>Metas Ativas</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-money-bill-wave"></i>
                    </div>
                    <div class="stat-content">
                        <h3 id="totalGoalsValue">R$ 0,00</h3>
                        <p>Valor Total das Metas</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-percentage"></i>
                    </div>
                    <div class="stat-content">
                        <h3 id="goalsCompletionRate">0%</h3>
                        <p>Taxa de Conclusão</p>
                    </div>
                </div>
            </div>

            <div class="goals-grid" id="goalsGrid">
                <!-- Goals will be loaded here -->
            </div>

            <div class="goals-timeline">
                <h3><i class="fas fa-calendar-alt"></i> Linha do Tempo das Metas</h3>
                <div class="timeline-container" id="goalsTimeline">
                    <!-- Timeline will be loaded here -->
                </div>
            </div>
        </section>

        <!-- Reports Page -->
        <section id="reportsPage" class="page">
            <div class="page-header">
                <h1><i class="fas fa-file-pdf"></i> Relatórios</h1>
                <p>Gere relatórios detalhados das suas finanças</p>
            </div>

            <div class="reports-actions">
                <div class="report-type-selector">
                    <button class="btn-report active" data-type="monthly" onclick="selectReportType('monthly')">
                        <i class="fas fa-calendar-month"></i>
                        <span>Mensal</span>
                    </button>
                    <button class="btn-report" data-type="annual" onclick="selectReportType('annual')">
                        <i class="fas fa-calendar-alt"></i>
                        <span>Anual</span>
                    </button>
                    <button class="btn-report" data-type="category" onclick="selectReportType('category')">
                        <i class="fas fa-chart-pie"></i>
                        <span>Por Categoria</span>
                    </button>
                    <button class="btn-report" data-type="custom" onclick="selectReportType('custom')">
                        <i class="fas fa-sliders-h"></i>
                        <span>Personalizado</span>
                    </button>
                </div>
            </div>

            <!-- Report Parameters -->
            <div class="report-parameters" id="reportParameters">
                <div class="parameter-group">
                    <label>Período:</label>
                    <select id="reportPeriod">
                        <option value="last_month">Último Mês</option>
                        <option value="this_month" selected>Este Mês</option>
                        <option value="last_quarter">Último Trimestre</option>
                        <option value="this_year">Este Ano</option>
                        <option value="last_year">Ano Passado</option>
                    </select>
                </div>
                <div class="parameter-group">
                    <label>Formato:</label>
                    <select id="reportFormat">
                        <option value="pdf">PDF</option>
                        <option value="excel">Excel</option>
                        <option value="csv">CSV</option>
                    </select>
                </div>
                <div class="parameter-group">
                    <label>Detalhamento:</label>
                    <select id="reportDetail">
                        <option value="summary">Resumido</option>
                        <option value="detailed" selected>Detalhado</option>
                        <option value="complete">Completo</option>
                    </select>
                </div>
                <button class="btn btn-primary" onclick="generateReport()">
                    <i class="fas fa-cog"></i> Gerar Relatório
                </button>
            </div>

            <!-- Report Preview -->
            <div class="report-preview" id="reportPreview">
                <div class="preview-header">
                    <h3><i class="fas fa-eye"></i> Pré-visualização</h3>
                    <button class="btn btn-secondary" onclick="downloadReport()" id="downloadBtn" style="display: none;">
                        <i class="fas fa-download"></i> Baixar
                    </button>
                </div>
                <div class="preview-content" id="reportPreviewContent">
                    <!-- Report preview will be shown here -->
                </div>
            </div>

            <!-- Report Templates -->
            <div class="report-templates">
                <h3><i class="fas fa-layer-group"></i> Modelos Prontos</h3>
                <div class="templates-grid">
                    <div class="template-card" onclick="loadTemplate('monthly_summary')">
                        <div class="template-icon">
                            <i class="fas fa-file-invoice-dollar"></i>
                        </div>
                        <h4>Resumo Mensal</h4>
                        <p>Visão geral das receitas e despesas do mês</p>
                    </div>
                    <div class="template-card" onclick="loadTemplate('category_analysis')">
                        <div class="template-icon">
                            <i class="fas fa-chart-pie"></i>
                        </div>
                        <h4>Análise por Categoria</h4>
                        <p>Detalhamento dos gastos por categoria</p>
                    </div>
                    <div class="template-card" onclick="loadTemplate('investment_tracking')">
                        <div class="template-icon">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <h4>Acompanhamento de Investimentos</h4>
                        <p>Evolução do patrimônio e investimentos</p>
                    </div>
                    <div class="template-card" onclick="loadTemplate('budget_vs_actual')">
                        <div class="template-icon">
                            <i class="fas fa-balance-scale"></i>
                        </div>
                        <h4>Orçado vs Realizado</h4>
                        <p>Comparação entre planejado e executado</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Settings Page -->
        <section id="settingsPage" class="page">
            <div class="page-header">
                <h1><i class="fas fa-cog"></i> Configurações</h1>
                <p>Personalize sua experiência no FinanceApp</p>
            </div>

            <div class="settings-tabs">
                <button class="tab-btn active" onclick="openSettingsTab('profile')">
                    <i class="fas fa-user"></i> Perfil
                </button>
                <button class="tab-btn" onclick="openSettingsTab('categories')">
                    <i class="fas fa-tags"></i> Categorias
                </button>
                <button class="tab-btn" onclick="openSettingsTab('notifications')">
                    <i class="fas fa-bell"></i> Notificações
                </button>
                <button class="tab-btn" onclick="openSettingsTab('appearance')">
                    <i class="fas fa-palette"></i> Aparência
                </button>
                <button class="tab-btn" onclick="openSettingsTab('backup')">
                    <i class="fas fa-database"></i> Backup
                </button>
                <button class="tab-btn" onclick="openSettingsTab('security')">
                    <i class="fas fa-shield-alt"></i> Segurança
                </button>
            </div>

            <!-- Profile Settings -->
            <div id="profileSettings" class="settings-content active">
                <h3><i class="fas fa-user-edit"></i> Perfil do Usuário</h3>
                <form id="profileForm" class="settings-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="settingsFirstName">Nome</label>
                            <input type="text" id="settingsFirstName" required>
                        </div>
                        <div class="form-group">
                            <label for="settingsLastName">Sobrenome</label>
                            <input type="text" id="settingsLastName">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="settingsEmail">Email</label>
                        <input type="email" id="settingsEmail" disabled>
                    </div>
                    <div class="form-group">
                        <label for="settingsAvatar">Foto de Perfil</label>
                        <div class="avatar-upload">
                            <img id="settingsAvatarPreview" src="https://ui-avatars.com/api/?name=U&background=49ac2a&color=fff" alt="Avatar">
                            <div class="upload-actions">
                                <button type="button" class="btn btn-secondary" onclick="document.getElementById('avatarInput').click()">
                                    <i class="fas fa-upload"></i> Escolher Foto
                                </button>
                                <input type="file" id="avatarInput" accept="image/*" style="display: none;" onchange="handleAvatarUpload(event)">
                                <button type="button" class="btn btn-danger" onclick="removeAvatar()">
                                    <i class="fas fa-trash"></i> Remover
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn btn-primary" onclick="saveProfileSettings()">
                            <i class="fas fa-save"></i> Salvar Alterações
                        </button>
                    </div>
                </form>
            </div>

            <!-- Categories Settings -->
            <div id="categoriesSettings" class="settings-content">
                <h3><i class="fas fa-tags"></i> Gerenciar Categorias</h3>
                <div class="categories-management">
                    <div class="categories-list">
                        <h4>Categorias Padrão</h4>
                        <div class="categories-grid" id="defaultCategories">
                            <!-- Default categories will be loaded here -->
                        </div>
                    </div>
                    <div class="custom-categories">
                        <h4>Suas Categorias Personalizadas</h4>
                        <div class="categories-grid" id="customCategories">
                            <!-- Custom categories will be loaded here -->
                        </div>
                        <button class="btn btn-secondary" onclick="openCategoryModal()">
                            <i class="fas fa-plus"></i> Nova Categoria
                        </button>
                    </div>
                </div>
            </div>

            <!-- Appearance Settings -->
            <div id="appearanceSettings" class="settings-content">
                <h3><i class="fas fa-palette"></i> Aparência e Tema</h3>
                <div class="theme-selector">
                    <h4>Escolha um Tema</h4>
                    <div class="themes-grid">
                        <div class="theme-card" data-theme="light" onclick="changeTheme('light')">
                            <div class="theme-preview light">
                                <div class="preview-header"></div>
                                <div class="preview-sidebar"></div>
                                <div class="preview-content"></div>
                            </div>
                            <span>Claro</span>
                        </div>
                        <div class="theme-card" data-theme="dark" onclick="changeTheme('dark')">
                            <div class="theme-preview dark">
                                <div class="preview-header"></div>
                                <div class="preview-sidebar"></div>
                                <div class="preview-content"></div>
                            </div>
                            <span>Escuro</span>
                        </div>
                        <div class="theme-card" data-theme="blue" onclick="changeTheme('blue')">
                            <div class="theme-preview blue">
                                <div class="preview-header"></div>
                                <div class="preview-sidebar"></div>
                                <div class="preview-content"></div>
                            </div>
                            <span>Azul</span>
                        </div>
                        <div class="theme-card" data-theme="green" onclick="changeTheme('green')">
                            <div class="theme-preview green">
                                <div class="preview-header"></div>
                                <div class="preview-sidebar"></div>
                                <div class="preview-content"></div>
                            </div>
                            <span>Verde</span>
                        </div>
                    </div>
                </div>
                <div class="color-customizer">
                    <h4>Personalizar Cores</h4>
                    <div class="color-pickers">
                        <div class="color-picker">
                            <label>Cor Primária</label>
                            <input type="color" id="primaryColor" value="#49ac2a" onchange="updatePrimaryColor(this.value)">
                        </div>
                        <div class="color-picker">
                            <label>Cor Secundária</label>
                            <input type="color" id="secondaryColor" value="#ffafd2" onchange="updateSecondaryColor(this.value)">
                        </div>
                        <div class="color-picker">
                            <label>Cor de Fundo</label>
                            <input type="color" id="backgroundColor" value="#f5f5f5" onchange="updateBackgroundColor(this.value)">
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Logout Page -->
        <section id="logoutPage" class="page logout-page">
            <div class="logout-container">
                <img src="https://i.ibb.co/9mt6zRFj/generated-image-removebg-preview.png" alt="FinanceApp" class="logout-logo">
                <h1><i class="fas fa-sign-out-alt"></i> Você saiu da sua conta</h1>
                <p>Para acessar novamente seus dados financeiros, faça login.</p>
                <button class="btn btn-primary" onclick="openLoginModal()">
                    <i class="fas fa-sign-in-alt"></i> Entrar Novamente
                </button>
            </div>
        </section>
    </main>

    <!-- MODALS -->
    
    <!-- Login Modal -->
    <div id="loginModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>
                    <img src="https://i.ibb.co/9mt6zRFj/generated-image-removebg-preview.png" alt="FinanceApp" class="modal-logo">
                    FinanceApp
                </h2>
                <span class="close" onclick="closeLoginModal()">&times;</span>
            </div>
            <div class="modal-body">
                <div id="loginSection">
                    <div class="form-group">
                        <label for="modalLoginEmail">Email</label>
                        <input type="email" id="modalLoginEmail" placeholder="seu@email.com">
                    </div>
                    <div class="form-group">
                        <label for="modalLoginPassword">Senha</label>
                        <input type="password" id="modalLoginPassword" placeholder="••••••••">
                    </div>
                    <button class="btn btn-primary btn-block" onclick="handleModalLogin()">
                        <i class="fas fa-sign-in-alt"></i> Entrar / Cadastrar
                    </button>
                    <div class="modal-footer">
                        <p id="modalLoginError" class="error-message"></p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Card Modal -->
    <div id="cardModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-credit-card"></i> Novo Cartão</h2>
                <span class="close" onclick="closeCardModal()">&times;</span>
            </div>
            <div class="modal-body">
                <form id="cardForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label>Banco</label>
                            <input type="text" id="cardBank" required>
                        </div>
                        <div class="form-group">
                            <label>Bandeira</label>
                            <select id="cardBrand" required>
                                <option value="">Selecione</option>
                                <option value="visa">Visa</option>
                                <option value="mastercard">Mastercard</option>
                                <option value="elo">Elo</option>
                                <option value="amex">American Express</option>
                                <option value="hipercard">Hipercard</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Últimos 4 dígitos</label>
                        <input type="text" id="cardLast4" maxlength="4" required>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Limite Total</label>
                            <input type="text" id="cardLimit" class="money-input" required>
                        </div>
                        <div class="form-group">
                            <label>Dia do Vencimento</label>
                            <input type="number" id="cardDueDay" min="1" max="31" required>
                        </div>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn btn-secondary" onclick="closeCardModal()">Cancelar</button>
                        <button type="button" class="btn btn-primary" onclick="saveCard()">Salvar Cartão</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Transaction Modal -->
    <div id="transactionModal" class="modal">
        <!-- Modal content for transactions -->
    </div>

    <!-- Category Modal -->
    <div id="categoryModal" class="modal">
        <!-- Modal content for categories -->
    </div>

    <!-- Goal Modal -->
    <div id="goalModal" class="modal">
        <!-- Modal content for goals -->
    </div>

    <!-- Notifications -->
    <div id="notificationsContainer" class="notifications-container"></div>

    <!-- Scripts -->
    <script src="js/auth.js"></script>
    <script src="js/finance.js"></script>
    <script src="js/charts.js"></script>
    <script src="js/reports.js"></script>
    <script src="js/goals.js"></script>
    <script src="js/notifications.js"></script>
    <script src="js/app.js"></script>

    <script>
        // Configuração do Supabase
        const SUPABASE_URL = 'https://lebfczoywiqkczppwuwg.supabase.co';
        const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImxlYmZjem95d2lxa2N6cHB3dXdnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjU5NzU2NDEsImV4cCI6MjA4MTU1MTY0MX0.wcbahZkGNp7AT6aTqwuVM3belEhVuqWVRb3MssoUKms';

        // Inicialização
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
        });
    </script>
</body>
</html>